<!doctype html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1, viewport-fit=cover'>
<title>RAI-Rev • Surgical Pause</title>
<link rel='manifest' href='manifest.json'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='black-translucent'>
<style>
:root{--bg:#0b0b0f;--card:#14141a;--text:#eaeaf2;--muted:#9aa0a6;--ok:#3ecf8e;--warn:#ffb020;--danger:#ff5470;--radius:16px}
*{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Helvetica Neue",Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text)}
.header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,rgba(11,11,15,.95),rgba(11,11,15,.85),transparent);padding:env(safe-area-inset-top) 16px 8px 16px}
.hstack{display:flex;align-items:center;gap:12px}.spacer{flex:1}
button,select{font:inherit;color:var(--text);background:var(--card);border:1px solid #2a2a34;border-radius:var(--radius);padding:10px;width:100%}
button{cursor:pointer}.primary{background:linear-gradient(180deg,#2563eb,#1d4ed8);border:none;color:#fff}
.card{background:var(--card);border:1px solid #1d1d25;border-radius:var(--radius);padding:16px;margin:12px 16px}
.label{font-size:13px;color:var(--muted);margin-bottom:6px}.section-title{font-weight:700;margin:6px 16px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;font-size:12px}
.grid{display:grid;grid-template-columns:1fr;gap:12px}.row{display:grid;grid-template-columns:1fr;gap:8px}
.score-big{font-size:48px;font-weight:800}.tier{font-weight:700}.robust{color:var(--ok)}.normal{color:#8ddfff}.frail{color:var(--warn)}.veryfrail{color:var(--danger)}
.small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<header class='header hstack'>
  <div class='hstack'><strong>RAI-Rev • Surgical Pause</strong></div><div class='spacer'></div>
  <button id='aboutBtn'>About</button>
</header>
<section class='card hstack' style='align-items:flex-end;gap:16px'>
  <div><div class='small'>Total RAI-Rev</div><div id='score' class='score-big'>0</div></div>
  <div class='spacer'></div>
  <div><div class='small'>Tier</div><div id='tier' class='tier robust'>Robust</div></div>
</section>
<div class='section-title'>14-item RAI-Rev</div>
<section class='card'><div class='grid'>
  <div class='row'><div class='label'>Age</div><select id='age'><option value='0'>&lt; 60</option><option value='6'>60–69</option><option value='9'>70–79</option><option value='13'>80–89</option><option value='15'>≥ 90</option></select></div>
  <div class='row'><div class='label'>Biological Sex</div><select id='sex'><option value='0'>Female</option><option value='6'>Male</option></select></div>
  <div class='row'><div class='label'>Active Cancer</div><select id='cancer'><option value='0'>No / Remission</option><option value='8'>Active</option></select></div>
  <div class='row'><div class='label'>Unintentional Weight Loss (≥10 lb / 3 mo)</div><select id='weightloss'><option value='0'>No</option><option value='9'>Yes</option></select></div>
  <div class='row'><div class='label'>Poor Appetite / Anorexia</div><select id='appetite'><option value='0'>No</option><option value='6'>Yes</option></select></div>
  <div class='row'><div class='label'>Congestive Heart Failure</div><select id='chf'><option value='0'>No</option><option value='7'>Yes</option></select></div>
  <div class='row'><div class='label'>Dyspnea at Rest</div><select id='sob'><option value='0'>No</option><option value='9'>Yes</option></select></div>
  <div class='row'><div class='label'>Renal Failure</div><select id='renal'><option value='0'>No</option><option value='10'>Yes</option></select></div>
  <div class='row'><div class='label'>Functional Status (ADLs)</div><select id='adl'><option value='0'>Independent</option><option value='5'>Some help</option><option value='10'>Dependent</option></select></div>
  <div class='row'><div class='label'>Cognitive Impairment</div><select id='cog'><option value='0'>No</option><option value='10'>Yes</option></select></div>
  <div class='row'><div class='label'>Living Situation</div><select id='living'><option value='0'>Home / Independent</option><option value='7'>Facility</option></select></div>
  <div class='row'><div class='label'>BMI &lt; 18.5</div><select id='bmi'><option value='0'>No</option><option value='5'>Yes</option></select></div>
  <div class='row'><div class='label'>Diabetes (Insulin-dependent)</div><select id='dm'><option value='0'>No / Diet / Oral meds</option><option value='6'>Insulin-dependent</option></select></div>
  <div class='row'><div class='label'>Hospitalization/Surgery in Last 6 Months</div><select id='recenthosp'><option value='0'>No</option><option value='5'>Yes</option></select></div>
</div>
<div style='height:8px'></div>
<div class='hstack' style='gap:8px'><button id='copyNoteBtn' class='primary'>Copy Pause Note</button><button id='resetBtn'>Reset</button></div>
<div class='small' style='margin-top:8px'>Thresholds: Robust ≤20 • Normal 21–29 • Frail 30–39 • Very Frail ≥40.</div>
</section>
<div class='section-title'>Surgical Pause</div>
<section class='card'>
  <label><input type='checkbox' id='chk1'> Indication & alternatives re-checked</label><br>
  <label><input type='checkbox' id='chk2'> Goals-of-care aligned; shared decision documented</label><br>
  <label><input type='checkbox' id='chk3'> Prehab/optimization (nutrition / PT / anemia / meds)</label><br>
  <label><input type='checkbox' id='chk4'> Periop plan updated (ICU readiness, DNR discussion)</label><br>
  <label><input type='checkbox' id='chk5'> Patient/family informed of frailty risk</label>
</section>
<script>
const THR={robustMax:20,normalMax:29,frailMax:39};
const fields=['age','sex','cancer','weightloss','appetite','chf','sob','renal','adl','cog','living','bmi','dm','recenthosp'];
function score(){return fields.reduce((s,id)=>s+parseInt(document.getElementById(id).value||'0',10),0)}
function tier(s){return s<=THR.robustMax?'Robust':s<=THR.normalMax?'Normal':s<=THR.frailMax?'Frail':'Very Frail'}
function render(){const s=score();document.getElementById('score').textContent=s;const t=tier(s);const el=document.getElementById('tier');el.textContent=t;el.className='tier '+(t==='Robust'?'robust':t==='Normal'?'normal':t==='Frail'?'frail':'veryfrail');if(t==='Frail'||t==='Very Frail'){for(let i=1;i<=5;i++){const c=document.getElementById('chk'+i);if(!c.dataset.userToggled)c.checked=true}}}
fields.forEach(id=>{const e=document.getElementById(id);['change','input'].forEach(evt=>e.addEventListener(evt,render))});
for(let i=1;i<=5;i++){const c=document.getElementById('chk'+i);c.addEventListener('change',()=>{c.dataset.userToggled='1'})}
document.getElementById('resetBtn').addEventListener('click',()=>{fields.forEach(f=>document.getElementById(f).selectedIndex=0);for(let i=1;i<=5;i++){const c=document.getElementById('chk'+i);c.checked=false;delete c.dataset.userToggled}render()});
document.getElementById('copyNoteBtn').addEventListener('click',async()=>{const s=score();const t=tier(s);let n=0;for(let i=1;i<=5;i++)if(document.getElementById('chk'+i).checked)n++;const note=`Frailty screen: RAI-Rev ${s} (${t}). Surgical Pause: ${n}/5 items checked.
• Indication/alternatives
• Goals-of-care + shared decision
• Prehab/optimization
• Periop plan update
• Patient/family communication`;try{await navigator.clipboard.writeText(note);alert('Note copied to clipboard.')}catch(e){prompt('Copy note:',note)}});
// SW v2 to force refresh
if('serviceWorker'in navigator){const sw=`const CACHE='rai-rev-v2';self.addEventListener('install',e=>{e.waitUntil(caches.open(CACHE).then(c=>c.addAll(['./','./index.html','./manifest.json','./icon.png'])));self.skipWaiting()});self.addEventListener('activate',e=>self.clients.claim());self.addEventListener('fetch',e=>{e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)))})`;const blob=new Blob([sw],{type:'text/javascript'});const url=URL.createObjectURL(blob);navigator.serviceWorker.register(url)}
render();
</script>
</body></html>
